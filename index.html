<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nursing Prometric Actual Simulation Test</title>
<style>
  body { margin:0; font-family: Arial,sans-serif; background:#f7f9fc; text-align:center; overflow-x:hidden; }
  
  /* Top image */
  .top-image {
    width:100%; height:50vh;
    background: url('https://github.com/gyoutrain-lab/production-prometrictest1/blob/main/assets/icon17%20(1).jpg?raw=true') no-repeat center/cover;
  }
  
  /* Floating title and subtitle */
  .title-container {
    position:absolute; top:0; width:100%; z-index:999;
    text-align:center; color:#042d62;
    padding-top:20px;
  }
  .title-container h1 { font-size:28px; margin:0; }
  .title-container h3 { font-size:18px; margin:5px 0; }

  .social-icons img { width:32px; margin:0 6px; cursor:pointer; }

  /* Bottom water with flowing effect */
  .bottom-water {
    width:100%; height:50vh;
    background: url('assets/water.jpg') repeat-x;
    animation: flow 10s linear infinite;
    opacity:0.4; filter: blur(3px);
  }
  @keyframes flow {
    from { background-position-x:0; }
    to { background-position-x:1000px; }
  }

  /* Form container */
  .form-container {
    max-width:300px; /* half smaller */
    margin: 20px auto 0 10%; /* moved left */
    padding:20px;
    background:white;
    border-radius:12px;
    box-shadow:0 0 15px rgba(0,0,0,0.1);
    text-align:left;
    transform: translateY(33%);
  }
  .form-container label { font-weight:bold; display:block; margin-top:10px; }
  .form-container input { width:100%; padding:10px; margin-top:5px; border-radius:6px; border:1px solid #bbb; font-size:16px; }

  /* Buttons */
  .form-container button { width:100%; margin-top:10px; padding:12px; font-size:16px; border:none; border-radius:6px; cursor:pointer; color:white; }
  #btnDemo { background:gold; color:black; }
  #btnConfirm { background:blue; }
  #btnContinue { background:green; }

  /* QR Code */
  .qr {
    position:absolute; right:10px; bottom:10px;
    width:20%; /* twice bigger */
    transform: translateY(33%);
  }

  /* Quiz container */
  .quiz-container { max-width:720px; margin:50px auto; background:white; padding:30px; border-radius:12px; box-shadow:0 0 15px rgba(0,0,0,0.15); display:none; text-align:center; }
  .question { font-size: 20px; margin: 20px 0; }
  .options button { width: 100%; padding:14px; margin:8px 0; font-size:18px; border-radius:6px; border:1px solid #bbb; cursor:pointer; }

  #msg { font-weight:bold; margin:15px 0; min-height:24px; }
</style>
</head>
<body>

<div class="top-image"></div>

<div class="title-container">
  <h1>Nursing Prometric Actual Simulation Test</h1>
  <h3>500 test items with tricky & hard level, rationale detailing, based on Prometric/SMLE & NCLEX</h3>
  <div class="social-icons">
    <a href="tel:+6285399652487"><img src="https://cdn-icons-png.flaticon.com/512/597/597177.png"></a>
    <a href="https://wa.me/6285399652487" target="_blank"><img src="https://cdn-icons-png.flaticon.com/512/733/733585.png"></a>
    <a href="mailto:gyoutrain@gmail.com" target="_blank"><img src="https://cdn-icons-png.flaticon.com/512/732/732200.png"></a>
    <a href="https://web.facebook.com/gyouskill/" target="_blank"><img src="https://cdn-icons-png.flaticon.com/512/733/733547.png"></a>
    <a href="https://www.instagram.com/etkyogya" target="_blank"><img src="https://cdn-icons-png.flaticon.com/512/733/733558.png"></a>
  </div>
</div>

<div class="form-container" id="landingForm">
  <label for="name">Full Name</label>
  <input type="text" id="name" placeholder="Enter your full name">
  
  <label for="wa">WhatsApp Number</label>
  <input type="text" id="wa" placeholder="e.g. 6285399652487">

  <label for="unlock">Unlock Code</label>
  <input type="text" id="unlock" placeholder="Enter Unlock Code">

  <button id="btnDemo" onclick="demoTest()">Demo Test (Free)</button>
  <button id="btnConfirm" onclick="confirmation()">Confirmation</button>
  <button id="btnContinue" onclick="continueTest()">Continue Next Test</button>
</div>

<div class="quiz-container" id="quizBox">
  <div class="question" id="questionText"></div>
  <div class="options">
    <button class="option-btn" id="optA" onclick="checkAnswer('A')"></button>
    <button class="option-btn" id="optB" onclick="checkAnswer('B')"></button>
    <button class="option-btn" id="optC" onclick="checkAnswer('C')"></button>
    <button class="option-btn" id="optD" onclick="checkAnswer('D')"></button>
  </div>
  <div id="msg"></div>
</div>

<img src="https://github.com/gyoutrain-lab/production-prometrictest1/blob/main/assets/dana_qr.png?raw=true" class="qr">

<!-- Audio effects -->
<audio id="audioCorrect" src="assets/correct.mp3" preload="auto"></audio>
<audio id="audioWrong" src="assets/wrong.mp3" preload="auto"></audio>

<script>
const backend = "https://script.google.com/macros/s/AKfycbyHtvmulVoW2r2DvJzPcCEtUpjBbwphDHrjw-9yO_LebrhdANdag3yYBygTWVKmbjNE/exec";

// ===== Landing Buttons =====
function demoTest(){
  window.open("https://script.google.com/macros/s/AKfycbzVzOVpdoPGiVe9dpwB0zoKbKIvD3WXGIz7wxr9AILS-fnbDP-GhGfnpki-GvTUxSk/exec","_blank");
}

function confirmation(){
  const name = document.getElementById("name").value.trim();
  const wa = document.getElementById("wa").value.trim();
  if(!name || !wa){ alert("Please fill in Name and WhatsApp number."); return; }

  fetch(backend, {
    method: "POST",
    body: JSON.stringify({ action:"confirmation", name:name, phone:wa }),
    headers: { "Content-Type":"application/json" },
    mode:"cors"
  })
  .then(r=>r.json())
  .then(d=>{
    alert(d.reply || "✅ Confirmation sent! Wait for Admin to approve and send unlock code via WA.");
  })
  .catch(e=>alert("Network error: "+e));
}

function continueTest(){
  const code = document.getElementById("unlock").value.trim();
  if(!code){ alert("Please enter the unlock code."); return; }

  fetch(backend+"?check="+encodeURIComponent(code))
    .then(r=>r.json())
    .then(d=>{
      if(d.ok){
        document.getElementById("landingForm").style.display="none";
        document.getElementById("quizBox").style.display="block";
        startQuiz(code);
      } else {
        alert("Invalid or expired unlock code.");
      }
    }).catch(e=>alert("Network error: "+e));
}

// ===== Quiz =====
let questions = [];
let currentIndex = 0, correctCount = 0, incorrectCount = 0;

function startQuiz(authCode){
  fetch(backend + "?questions=true")
    .then(r=>r.json())
    .then(data=>{
      questions = data;
      currentIndex = 0; correctCount=0; incorrectCount=0;
      loadQuestion();
    })
    .catch(e=>{
      alert("Failed to load questions: "+e);
    });
}

function loadQuestion(){
  const current = questions[currentIndex];
  document.getElementById("questionText").innerText = `Q${current.number}: ${current.question}`;
  document.getElementById("optA").innerText = "A. "+current.options[0];
  document.getElementById("optB").innerText = "B. "+current.options[1];
  document.getElementById("optC").innerText = "C. "+current.options[2];
  document.getElementById("optD").innerText = "D. "+current.options[3];
  document.getElementById("msg").innerText = "";
}

function checkAnswer(selected){
  const current = questions[currentIndex];
  const audioCorrect = document.getElementById("audioCorrect");
  const audioWrong = document.getElementById("audioWrong");

  if(selected === current.correct){
    correctCount++;
    audioCorrect.currentTime = 0; audioCorrect.play();
    document.getElementById("msg").innerText = "✅ Correct!";
  } else {
    incorrectCount++;
    audioWrong.currentTime = 0; audioWrong.play();
    document.getElementById("msg").innerText = `❌ Wrong! Correct: ${current.correct}\n${current.rationale}`;
  }

  currentIndex++;
  if(currentIndex < questions.length){
    setTimeout(loadQuestion,1200);
  } else {
    setTimeout(showScore,1200);
  }
}

function showScore(){
  const score = Math.round((correctCount/questions.length)*100);
  const status = score >= 70 ? "PASS":"NOT PASS";
  document.getElementById("quizBox").innerHTML = `<h2>Test Completed</h2>
    <p>Correct: ${correctCount} / ${questions.length}</p>
    <p>Incorrect: ${incorrectCount} / ${questions.length}</p>
    <p>Score: ${score}%</p>
    <p>Status: ${status}</p>`;
}
</script>
</body>
</html>
